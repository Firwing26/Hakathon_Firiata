<?php

require('../vendor/autoload.php');

$app = new Silex\Application();
$app['debug'] = true;

$app->register(new Silex\Provider\MonologServiceProvider(), array(
  'monolog.logfile' => 'php://stderr',
));


$app->get('/', function() use($app) {
    return "HELLO WORLD";
});

$app->post('/', function() use($app) {
      $data = json_decode(file_get_contents('php://input'));

      if( !$data )
         return "nook";

      if( $data->secret !== getenv('VK_SECRET_TOKEN') && $data->type !== 'confirmation' )
        return "nook";

      switch ( $data->type )
      {
        case 'confirmation':
          return getenv('VK_CONFIRMATION_CODE');
          break;

        case 'message_new':
             $slovo = $data->object->body;
             $request_params = array(
               'user_id' => $data->object->user_id,
               'message' => 'Ğ½ĞµĞ¿Ğ¾Ğ½ÑĞ»',
               'access_token' => getenv('VK_TOKEN'),
               'v' => '5.50'
             );
             $problem = array(
               'first' => 'ĞºÑƒÑ€Ğ¸Ñ‚',
               'sekond' => 'ÑĞ±ĞµĞ³Ğ°ĞµÑ‚',
               'sleng'  => 'ÑĞ»ĞµĞ½Ğ³',
               'lock' => 'Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚'
             );

              if ($slovo == 'Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚')  {
                 $request_params['message'] = 'ĞŸÑ€Ğ¸Ğ²ĞµÑ‚ÑÑ‚Ğ²ÑƒÑ Ğ½Ğ° Ğ¿ÑƒÑ‚Ğ¸ Ğ¿Ñ€Ğ¾ÑĞ²ĞµÑ‰ĞµĞ½Ğ¸Ñ.ğŸ¤”
                Ğ¯ Ğ³Ğ¾Ñ‚Ğ¾Ğ² Ğ¿Ğ¾Ğ¼Ğ¾Ñ‡ÑŒ Ğ² Ñ‚Ñ€ÑƒĞ´Ğ½ÑƒÑ Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñƒ Ğ½ĞµĞ¿Ğ¾Ğ½Ğ¸Ğ°Ğ½Ğ¸Ñ Ğ´ĞµÑ‚ĞµĞ¹ Ğ¸ Ñ€Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»Ğµ Ğ¿Ğ¾Ğ´ÑĞºĞ°Ğ·Ğ°Ğ² Ñ‡Ñ‚Ğ¾ Ğ¼Ğ¾Ğ³Ğ»Ğ¾ ÑÑ‚Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¸Ñ‡Ğ¸Ğ½Ğ¾Ğ¹, ĞºĞ°Ğº ÑÑ‚Ğ¾Ğ³Ğ¾ Ğ¸Ğ·Ğ±ĞµĞ¶Ğ°Ñ‚ÑŒ Ğ¸ ĞºĞ°Ğº ÑÑ‚Ğ¾ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ.  Ğ¯ Ğ¿Ğ¾Ğ¼Ğ¾Ğ³Ñƒ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ°Ğ² Ğ´Ğ¾Ğ±Ñ€Ñ‹Ğ¼ ÑĞ»Ğ¾Ğ²Ğ¾Ğ¼.
                Ğ•ÑĞ»Ğ¸ Ñ…Ğ¾Ñ‡ĞµÑˆÑŒ Ğ¿Ğ¾Ğ¾Ğ±Ñ‰Ğ°Ñ‚ÑŒÑÑ Ñ‚Ğ¾ Ñ Ğ¾Ñ‚Ğ²ĞµÑ‡Ğ°Ñ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ½Ğ° ĞºĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ ÑĞ»Ğ¾Ğ²Ğ°, Ğ¸Ñ… Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ ĞºĞ¾Ğ¼Ğ±ĞµĞ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°Ñ‚ÑŒ Ğ¸Ğ½Ğ½Ğ¾Ğ¹ Ğ¾Ñ‚Ğ²ĞµÑ‚ Ğ½Ğµ Ğ¶ĞµĞ»Ğ¸ ÑĞ¿Ñ€Ğ°ÑˆĞ¸Ğ²Ğ°Ñ‚ÑŒ Ğ¾ Ğ½Ğ¸Ñ… Ğ² Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸.
                Ğ¯ Ğ·Ğ½Ğ°Ñ Ñ‚Ğ°ĞºĞ¸Ğµ ĞºĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ ÑĞ»Ğ¾Ğ²Ğ°:
                ĞºÑƒÑ€Ğ¸Ñ‚
                ÑĞ±ĞµĞ³Ğ°ĞµÑ‚
                Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚
                ĞŸĞ¾Ğ¼Ğ¸Ğ¼Ğ¾ ÑÑ‚Ğ¾Ğ³Ğ¾ Ñ Ğ¼Ğ¾Ğ³Ñƒ Ñ€Ğ°ÑĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ¾ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¸ ÑĞ»ĞµĞ½Ğ³Ğ¾Ğ²Ñ‹Ñ… ÑĞ»Ğ¾Ğ². ĞŸÑ€Ğ¾ÑÑ‚Ğ¾ Ğ½Ğ°Ğ¿Ğ¸ÑˆĞ¸ ÑĞ»ĞµĞ½Ğ³' ;
               }


             if ($slovo == $problem['lock'])  {
                $request_params['message'] = 'Ğ­Ñ‚Ğ¾ Ñ‡Ğ°ÑÑ‚Ğ¾ Ğ±Ñ‹Ğ²Ğ°Ğµ Ğ²Ñ‹Ğ·Ğ²Ğ°Ğ½Ğ½Ğ¾ ÑĞ°Ğ¼Ğ¾ĞºĞ¾Ğ¿Ğ°Ğ½Ğ¸Ğµ, Ğ¸Ğ·Ğ´ĞµĞ²Ğ°Ñ‚ĞµĞ»ÑŒÑÑ‚Ğ²Ğ¾Ğ¼ ÑĞ¾ ÑÑ‚Ğ¾Ñ€Ğ¾Ğ½Ñ‹ Ğ¾ĞºÑ€ÑƒĞ¶Ğ°ÑÑ‰Ğ¸Ñ…, Ğ²ĞºĞ»ÑÑ‡Ğ°Ñ Ğ²Ğ°Ñ. Ğ¢Ğ°Ğº Ğ¶Ğµ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ ĞµĞ³Ğ¾ Ğ¼Ğ½ĞµĞ½Ğ¸Ğµ Ğ¸Ğ»Ğ¸ ÑĞ»Ğ¾Ğ²Ğ° Ñ‡Ğ°ÑÑ‚Ğ¾ Ğ½Ğµ ÑÑ‚Ğ°Ğ²Ğ¸Ğ»Ğ¸ Ğ½Ğ¸ Ğ²Ğ¾ Ñ‡Ñ‚Ğ¾ Ğ¸ Ñ€ĞµĞ±ĞµĞ½Ğ¾Ğº Ñ€ĞµÑˆĞ¸Ğ» Ñ‡Ñ‚Ğ¾ Ğ½ĞµÑ‚ ÑĞ¼Ñ‹ÑĞ»Ğ° Ğ³Ğ¾Ğ²Ğ¾Ñ€Ğ¸Ñ‚ÑŒ Ğ²ĞµĞ´ÑŒ Ğ²ÑĞµ Ğ·Ğ°ĞºĞ¾Ğ½Ñ‡Ğ¸Ñ‚ÑŒÑÑ Ğ¾Ğ´Ğ¸Ğ½Ğ°ĞºĞ¾Ğ²Ğ¾' ;
             }


             if ($slovo == $problem['sleng'])  {
                $request_params['message'] = 'Ğ—Ğ´ĞµÑÑŒ Ğ±ÑƒĞ´ÑƒÑ‚ Ñ€Ğ°ÑĞ¿Ğ¾Ğ»Ğ¾Ğ³Ğ°Ñ‚ÑŒÑÑ ÑĞ»Ğ¾Ğ²Ğ° Ğ¸ Ğ¸Ñ… Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğµ ÑĞµĞ¹Ñ‡Ğ°Ñ Ğ½Ğ°Ñ…Ğ¾Ğ´ÑÑ‚ÑÑ Ğ² Ğ¾Ğ±Ğ¸Ñ…Ğ¾Ğ´Ğµ Ğ¼Ğ¾Ğ»Ğ¾Ğ´ĞµĞ¶Ğ¸' ;
             }

             if ($slovo == 'ĞºÑƒÑ€Ğ¸Ñ‚ Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚' or $slovo == 'Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚ ĞºÑƒÑ€Ğ¸Ñ‚')  {
                $request_params['message'] = 'ÑÑ‚Ğ¾ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ²Ñ‹Ğ·Ğ²Ğ°Ğ½Ğ½Ğ¾ Ğ´ÑƒÑˆĞµĞ²Ğ½Ğ¾Ğ¹ ÑĞ»Ğ¾Ğ¼Ğ»ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒÑ Ğ¸ ÑƒÑÑ‚Ğ°Ğ»Ğ¾ÑÑ‚ÑŒÑ Ğ¾Ñ‚ Ğ¶Ğ¸Ğ·Ğ½Ğ¸' ;
              }

              if ($slovo == 'ĞºÑƒÑ€Ğ¸Ñ‚ Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚ ÑĞ±ĞµĞ³Ğ°ĞµÑ‚' or $slovo == 'Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚ ĞºÑƒÑ€Ğ¸Ñ‚ ÑĞ±ĞµĞ³Ğ°ĞµÑ‚' or $slovo == 'ÑĞ±ĞµĞ³Ğ°ĞµÑ‚ Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚ ĞºÑƒÑ€Ğ¸Ñ‚' or $slovo == 'Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚ ÑĞ±ĞµĞ³Ğ°ĞµÑ‚ ĞºÑƒÑ€Ğ¸Ñ‚' or $slovo == 'ÑĞ±ĞµĞ³Ğ°ĞµÑ‚ ĞºÑƒÑ€Ğ¸Ñ‚ Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚' or $slovo == 'ĞºÑƒÑ€Ğ¸Ñ‚ ÑĞ±ĞµĞ³Ğ°ĞµÑ‚ Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚')  {
                 $request_params['message'] = 'Ğ§Ğ°ÑÑ‚Ğ¾ ÑÑ‚Ğ¾ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ¾Ğ·Ğ½Ğ°Ñ‡Ğ°Ñ‚ÑŒ ÑƒÑÑ‚Ğ°Ğ»Ğ¾ÑÑ‚ÑŒ Ğ¾Ñ‚ Ğ¶Ğ¸Ğ·Ğ½Ğ¸ Ğ² Ğ¿ĞµÑ€ĞµĞ¼ĞµÑˆĞºÑƒ Ñ Ğ¶ĞµĞ»Ğ°Ğ½Ğ¸ĞµĞ¼ Ğ½Ğ°Ñ‡Ğ°Ñ‚ÑŒ Ğ²ÑĞµ Ñ Ñ‡Ğ¸ÑÑ‚Ğ¾Ğ³Ğ¾ Ğ»Ğ¸ÑĞ°Ñ‚Ğ° Ğ¸ Ğ²Ñ‹Ñ€Ğ²Ğ°Ñ‚ÑŒÑÑ Ğ¸Ğ· ÑÑ‚Ğ¾Ğ³Ğ¾ ĞºÑ€ÑƒĞ³Ğ¾Ğ²Ğ¾Ñ€Ğ¾Ñ‚Ğ°' ;
               }

             if ($slovo == 'ÑĞ±ĞµĞ³Ğ°ĞµÑ‚ Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚' or $slovo == 'Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚ ÑĞ±ĞµĞ³Ğ°ĞµÑ‚')  {
                $request_params['message'] = 'ÑĞºĞ¾Ñ€ĞµĞµ Ğ²ÑĞµĞ³Ğ¾ Ğ² ÑÑ‚Ğ¾Ğ¼ Ğ²Ğ°ÑˆĞ° Ğ²Ğ¸Ğ½Ğ°. Ğ¿ĞµÑ€ĞµÑĞ¼Ğ¾Ñ‚Ñ€Ğ¸Ñ‚Ğµ ÑĞ²Ğ¾Ğµ Ğ¾Ñ‚Ğ½Ğ¾ÑˆĞµĞ½Ğ¸Ğµ Ğº Ñ€ĞµĞ±ĞµĞ½ĞºÑƒ Ğ¿Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€Ğ¸Ñ‚Ğµ Ğ½Ğ° Ñ‚Ğ¾ ĞºĞ°Ğº Ğ²Ñ‹ Ñ Ğ½Ğ¸Ğ¼ Ğ¾Ğ±Ñ‰Ğ°ĞµÑ‚ĞµÑÑŒ Ğ¸ Ğº Ğ½ĞµĞ¼Ñƒ Ğ¾Ñ‚Ğ½Ğ¾ÑĞ¸Ñ‚ĞµÑÑŒ. Ğ¿Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€Ğ¸Ñ‚Ğµ Ğ½Ğ° ÑÑ‚Ğ¾ Ğ²ÑĞµ ĞµĞ³Ğ¾ Ğ³Ğ»Ğ°Ğ·Ğ°Ğ¼Ğ¸ Ğ¸ ÑĞ¿Ñ€Ğ¾ÑĞ¸Ñ‚Ğµ ÑĞµĞ±Ñ Ğ¿Ğ¾Ğ½Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ¾ÑÑŒ Ğ±Ñ‹ Ğ²Ğ°Ğ¼ Ñ‚Ğ°ĞºĞ¾Ğµ Ğ¾Ñ‚Ğ½Ğ¾ÑˆĞµĞ½Ğ¸Ğµ Ğº ÑĞµĞ±Ğµ' ;
              }

             if ($slovo == 'ĞºÑƒÑ€Ğ¸Ñ‚ ÑĞ±ĞµĞ³Ğ°ĞµÑ‚' or $slovo == 'ÑĞ±ĞµĞ³Ğ°ĞµÑ‚ ĞºÑƒÑ€Ğ¸Ñ‚')  {
                 $request_params['message'] = 'Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ Ğ¼Ğ¾Ğ³Ğ»Ğ¸ Ğ²Ñ‹Ğ¹Ñ‚Ğ¸ Ğ¸Ğ· Ñ‚ÑĞ¶ĞµĞ»Ñ‹Ñ… Ğ´ÑƒÑˆĞµĞ²Ğ½Ñ‹Ñ… Ğ²Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğ¹' ;
              }

             if ($slovo == $problem['sekond']) {
                $request_params['message'] = 'Ğš ÑÑ‚Ğ¾Ğ¼Ñƒ Ğ¼Ğ¾Ğ³Ğ»Ğ¾ Ğ¿Ñ€Ğ¸Ğ²ĞµÑÑ‚Ğ¸ Ğ½ĞµĞ¿Ğ¾Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ Ğ² ÑĞµĞ¼ÑŒĞµ.
                 Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ñ€ĞµĞ±ĞµĞ½Ğ¾Ğº ÑƒĞ²Ğ¸Ğ´ĞµĞ» ĞºĞ°ĞºĞ¾Ğµ Ğ¾Ñ‚Ğ½Ğ¾ÑˆĞµĞ½Ğ¸Ğµ Ğ¼ĞµĞ¶Ğ´Ñƒ ĞµĞ³Ğ¾ Ğ´Ñ€ÑƒĞ·ÑŒÑĞ¼Ğ¸ Ğ¸ Ğ¸Ñ… Ñ€Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑĞ¼Ğ¸ Ğ¸ ÑĞ´ĞµĞ»Ğ°Ğ² Ğ²Ñ‹Ğ²Ğ¾Ğ´ Ğ¾ Ñ‚Ğ¾Ğ¼ Ñ‡Ñ‚Ğ¾ Ğ² ĞµĞ³Ğ¾ Ğ¶Ğ¸Ğ·Ğ½Ğ¸ Ñ‡Ñ‚Ğ¾ Ñ‚Ğ¾ Ğ½Ğµ Ñ‚Ğ°Ğº Ñ€ĞµÑˆĞ¸Ğ» Ğ¿ÑƒÑ‚ĞµĞ¼ Ğ¿Ğ¾Ğ±ĞµĞ³Ğ° Ğ½Ğ°Ñ‡Ğ°Ñ‚ÑŒ Ğ²ÑĞµ Ñ Ñ‡Ğ¸ÑÑ‚Ğ¾Ğ³Ğ¾ Ğ»Ğ¸ÑÑ‚Ğ°';
             }
             if ($slovo == $problem['first']) {
                $request_params['message'] = 'ĞŸÑ€Ğ¸Ñ‡Ğ¸Ğ½Ğ¾Ğ¹ ÑÑ‚Ğ¾Ğ³Ğ¾ Ğ¼Ğ¾Ğ³Ğ»Ğ¾ ÑÑ‚Ğ°Ñ‚ÑŒ Ğ¼Ğ°Ğ»Ğ¾Ğµ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ ÑƒĞ´ĞµĞ»ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ Ñ€ĞµĞ±ĞµĞ½ĞºÑƒ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ Ğ¸Ğ»Ğ¸ Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ğµ ĞµĞ³Ğ¾ Ğ¾Ñ‚ Ğ´Ğ°Ğ½Ğ½Ğ¾Ğ¹ Ğ¿Ğ»Ğ¾Ñ…Ğ¾Ğ¹ Ğ¿Ñ€Ğ¸Ğ²Ñ‹Ñ‡ĞºĞ¸ Ğ²Ğ¼ĞµÑÑ‚Ğ¾ Ñ‚Ğ¾Ğ³Ğ¾ Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ğ¾ Ğ¾Ğ±ÑŠÑÑĞ½Ğ¸Ñ‚ÑŒ Ñ‡Ñ‚Ğ¾ Ñ‚Ğ°ĞºĞ¾Ğµ ĞºÑƒÑ€ĞµĞ½Ğ¸Ğµ Ğ¸ Ğº Ñ‡ĞµĞ¼Ñƒ Ğ¾Ğ½Ğ¾ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ¿Ñ€Ğ¸Ğ²ĞµÑÑ‚Ğ¸';
             }


// ĞŸĞ¾ĞºĞ° Ğ¼Ğ½Ğ¾Ğ³Ğ¾ ĞºĞ¾ÑÑ‚Ñ‹Ğ»ĞµĞ¹.... Ğ¾Ñ‡ĞµĞ½ÑŒ Ğ¼Ğ½Ğ¾Ğ³Ğ¾ ĞºĞ¾ÑÑ‚Ñ‹Ğ»ĞµĞ¹

             file_get_contents('https://api.vk.com/method/messages.send?' . http_build_query($request_params));


             return 'ok';
             break;
      }


        return "nook";


        exit('ok');

});

$app->run();
